import unittest

import cellpylib as cpl


class TestBiEntropy(unittest.TestCase):

    def test_binary_derivative(self):
        self.assertEqual(cpl.binary_derivative('01010101'), '1111111')
        self.assertEqual(cpl.binary_derivative('1111111'), '000000')
        self.assertEqual(cpl.binary_derivative('000000'), '00000')
        self.assertEqual(cpl.binary_derivative('00000'), '0000')
        self.assertEqual(cpl.binary_derivative('0000'), '000')
        self.assertEqual(cpl.binary_derivative('000'), '00')
        self.assertEqual(cpl.binary_derivative('00'), '0')
        self.assertEqual(cpl.binary_derivative('0'), '')
        self.assertEqual(cpl.binary_derivative('00010001'), '0011001')
        self.assertEqual(cpl.binary_derivative('0011001'), '010101')
        self.assertEqual(cpl.binary_derivative('010101'), '11111')
        self.assertEqual(cpl.binary_derivative('11111'), '0000')
        self.assertEqual(cpl.binary_derivative('00011111'), '0010000')
        self.assertEqual(cpl.binary_derivative('0010000'), '011000')
        self.assertEqual(cpl.binary_derivative('011000'), '10100')
        self.assertEqual(cpl.binary_derivative('10100'), '1110')
        self.assertEqual(cpl.binary_derivative('1110'), '001')
        self.assertEqual(cpl.binary_derivative('001'), '01')
        self.assertEqual(cpl.binary_derivative('01'), '1')
        self.assertEqual(cpl.binary_derivative('1'), '')

    def test_bien(self):
        # 2-bit strings
        self.assertEqual(cpl.bien('00'), 0.0)
        self.assertEqual(cpl.bien('01'), 1.0)
        self.assertEqual(cpl.bien('10'), 1.0)
        self.assertEqual(cpl.bien('11'), 0.0)
        # 4-bit strings, asserts equality to 7 decimal places
        self.assertAlmostEqual(cpl.bien('0000'), 0.0)
        self.assertAlmostEqual(cpl.bien('0001'), 0.9496956846525874)
        self.assertAlmostEqual(cpl.bien('0010'), 0.9496956846525874)
        self.assertAlmostEqual(cpl.bien('0011'), 0.40522738115842555)
        self.assertAlmostEqual(cpl.bien('0100'), 0.9496956846525874)
        self.assertAlmostEqual(cpl.bien('0101'), 0.14285714285714285)
        self.assertAlmostEqual(cpl.bien('0110'), 0.40522738115842555)
        self.assertAlmostEqual(cpl.bien('0111'), 0.9496956846525874)
        self.assertAlmostEqual(cpl.bien('1000'), 0.9496956846525874)
        self.assertAlmostEqual(cpl.bien('1001'), 0.40522738115842555)
        self.assertAlmostEqual(cpl.bien('1010'), 0.14285714285714285)
        self.assertAlmostEqual(cpl.bien('1011'), 0.9496956846525874)
        self.assertAlmostEqual(cpl.bien('1100'), 0.40522738115842555)
        self.assertAlmostEqual(cpl.bien('1101'), 0.9496956846525874)
        self.assertAlmostEqual(cpl.bien('1110'), 0.9496956846525874)
        self.assertAlmostEqual(cpl.bien('1111'), 0.0)
        # 8-bit strings, asserts equality to 7 decimal places
        self.assertAlmostEqual(cpl.bien('00000000'), 0.0)
        self.assertAlmostEqual(cpl.bien('00000001'), 0.9170735521822547)
        self.assertAlmostEqual(cpl.bien('00000010'), 0.9370347771941213)
        self.assertAlmostEqual(cpl.bien('00000011'), 0.44747006666680555)
        self.assertAlmostEqual(cpl.bien('00000100'), 0.9454843334903775)
        self.assertAlmostEqual(cpl.bien('00000101'), 0.22952306172250708)
        self.assertAlmostEqual(cpl.bien('00000110'), 0.454318194570354)
        self.assertAlmostEqual(cpl.bien('00000111'), 0.9444447585278324)
        self.assertAlmostEqual(cpl.bien('00001000'), 0.9297978768247205)
        self.assertAlmostEqual(cpl.bien('00001001'), 0.4719276050543988)
        self.assertAlmostEqual(cpl.bien('00001010'), 0.22952306172250708)
        self.assertAlmostEqual(cpl.bien('00001011'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('00001100'), 0.45174483501301504)
        self.assertAlmostEqual(cpl.bien('00001101'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('00001110'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('00001111'), 0.10727664290566898)
        self.assertAlmostEqual(cpl.bien('00010000'), 0.9297978768247205)
        self.assertAlmostEqual(cpl.bien('00010001'), 0.053399483437225476)
        self.assertAlmostEqual(cpl.bien('00010010'), 0.4562411483887417)
        self.assertAlmostEqual(cpl.bien('00010011'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('00010100'), 0.23797261801876332)
        self.assertAlmostEqual(cpl.bien('00010101'), 0.9402699705777856)
        self.assertAlmostEqual(cpl.bien('00010110'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('00010111'), 0.45515378785140964)
        self.assertAlmostEqual(cpl.bien('00011000'), 0.46743129167867215)
        self.assertAlmostEqual(cpl.bien('00011001'), 0.9265064677305163)
        self.assertAlmostEqual(cpl.bien('00011010'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('00011011'), 0.23945861703877014)
        self.assertAlmostEqual(cpl.bien('00011100'), 0.9487195268740418)
        self.assertAlmostEqual(cpl.bien('00011101'), 0.45772714740874854)
        self.assertAlmostEqual(cpl.bien('00011110'), 0.1141247708092174)
        self.assertAlmostEqual(cpl.bien('00011111'), 0.9444447585278324)
        self.assertAlmostEqual(cpl.bien('00100000'), 0.9454843334903775)
        self.assertAlmostEqual(cpl.bien('00100001'), 0.4562411483887417)
        self.assertAlmostEqual(cpl.bien('00100010'), 0.053399483437225476)
        self.assertAlmostEqual(cpl.bien('00100011'), 0.9349560240267725)
        self.assertAlmostEqual(cpl.bien('00100100'), 0.4536677888314028)
        self.assertAlmostEqual(cpl.bien('00100101'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('00100110'), 0.9421929243961734)
        self.assertAlmostEqual(cpl.bien('00100111'), 0.23945861703877014)
        self.assertAlmostEqual(cpl.bien('00101000'), 0.23797261801876332)
        self.assertAlmostEqual(cpl.bien('00101001'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('00101010'), 0.920308745565919)
        self.assertAlmostEqual(cpl.bien('00101011'), 0.468917290698679)
        self.assertAlmostEqual(cpl.bien('00101100'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('00101101'), 0.1141247708092174)
        self.assertAlmostEqual(cpl.bien('00101110'), 0.45772714740874854)
        self.assertAlmostEqual(cpl.bien('00101111'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('00110000'), 0.45174483501301504)
        self.assertAlmostEqual(cpl.bien('00110001'), 0.9421929243961734)
        self.assertAlmostEqual(cpl.bien('00110010'), 0.9265064677305163)
        self.assertAlmostEqual(cpl.bien('00110011'), 0.023389419465106323)
        self.assertAlmostEqual(cpl.bien('00110100'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('00110101'), 0.4558041935903608)
        self.assertAlmostEqual(cpl.bien('00110110'), 0.2310090607425139)
        self.assertAlmostEqual(cpl.bien('00110111'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('00111000'), 0.9487195268740418)
        self.assertAlmostEqual(cpl.bien('00111001'), 0.2310090607425139)
        self.assertAlmostEqual(cpl.bien('00111010'), 0.47341360407440564)
        self.assertAlmostEqual(cpl.bien('00111011'), 0.9349560240267725)
        self.assertAlmostEqual(cpl.bien('00111100'), 0.1115514112518785)
        self.assertAlmostEqual(cpl.bien('00111101'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('00111110'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('00111111'), 0.44747006666680555)
        self.assertAlmostEqual(cpl.bien('01000000'), 0.9370347771941213)
        self.assertAlmostEqual(cpl.bien('01000001'), 0.23797261801876332)
        self.assertAlmostEqual(cpl.bien('01000010'), 0.4536677888314028)
        self.assertAlmostEqual(cpl.bien('01000011'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('01000100'), 0.053399483437225476)
        self.assertAlmostEqual(cpl.bien('01000101'), 0.9330330702083848)
        self.assertAlmostEqual(cpl.bien('01000110'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('01000111'), 0.45772714740874854)
        self.assertAlmostEqual(cpl.bien('01001000'), 0.4562411483887417)
        self.assertAlmostEqual(cpl.bien('01001001'), 0.9487195268740418)
        self.assertAlmostEqual(cpl.bien('01001010'), 0.9444447585278324)
        self.assertAlmostEqual(cpl.bien('01001011'), 0.1141247708092174)
        self.assertAlmostEqual(cpl.bien('01001100'), 0.9265064677305163)
        self.assertAlmostEqual(cpl.bien('01001101'), 0.468917290698679)
        self.assertAlmostEqual(cpl.bien('01001110'), 0.23945861703877014)
        self.assertAlmostEqual(cpl.bien('01001111'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('01010000'), 0.22952306172250708)
        self.assertAlmostEqual(cpl.bien('01010001'), 0.9487195268740418)
        self.assertAlmostEqual(cpl.bien('01010010'), 0.9444447585278324)
        self.assertAlmostEqual(cpl.bien('01010011'), 0.4558041935903608)
        self.assertAlmostEqual(cpl.bien('01010100'), 0.920308745565919)
        self.assertAlmostEqual(cpl.bien('01010101'), 0.007874015748031496)
        self.assertAlmostEqual(cpl.bien('01010110'), 0.4489560656868124)
        self.assertAlmostEqual(cpl.bien('01010111'), 0.9402699705777856)
        self.assertAlmostEqual(cpl.bien('01011000'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('01011001'), 0.4532308340330219)
        self.assertAlmostEqual(cpl.bien('01011010'), 0.10727664290566899)
        self.assertAlmostEqual(cpl.bien('01011011'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('01011100'), 0.47341360407440564)
        self.assertAlmostEqual(cpl.bien('01011101'), 0.9330330702083848)
        self.assertAlmostEqual(cpl.bien('01011110'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('01011111'), 0.22952306172250708)
        self.assertAlmostEqual(cpl.bien('01100000'), 0.454318194570354)
        self.assertAlmostEqual(cpl.bien('01100001'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('01100010'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('01100011'), 0.2310090607425139)
        self.assertAlmostEqual(cpl.bien('01100100'), 0.9421929243961734)
        self.assertAlmostEqual(cpl.bien('01100101'), 0.4532308340330219)
        self.assertAlmostEqual(cpl.bien('01100110'), 0.023389419465106323)
        self.assertAlmostEqual(cpl.bien('01100111'), 0.9265064677305163)
        self.assertAlmostEqual(cpl.bien('01101000'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('01101001'), 0.1115514112518785)
        self.assertAlmostEqual(cpl.bien('01101010'), 0.4489560656868124)
        self.assertAlmostEqual(cpl.bien('01101011'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('01101100'), 0.2310090607425139)
        self.assertAlmostEqual(cpl.bien('01101101'), 0.9487195268740418)
        self.assertAlmostEqual(cpl.bien('01101110'), 0.9349560240267725)
        self.assertAlmostEqual(cpl.bien('01101111'), 0.4719276050543988)
        self.assertAlmostEqual(cpl.bien('01110000'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('01110001'), 0.45515378785140964)
        self.assertAlmostEqual(cpl.bien('01110010'), 0.23945861703877014)
        self.assertAlmostEqual(cpl.bien('01110011'), 0.9421929243961734)
        self.assertAlmostEqual(cpl.bien('01110100'), 0.45772714740874854)
        self.assertAlmostEqual(cpl.bien('01110101'), 0.9487195268740418)
        self.assertAlmostEqual(cpl.bien('01110110'), 0.9349560240267725)
        self.assertAlmostEqual(cpl.bien('01110111'), 0.053399483437225476)
        self.assertAlmostEqual(cpl.bien('01111000'), 0.1141247708092174)
        self.assertAlmostEqual(cpl.bien('01111001'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('01111010'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('01111011'), 0.4562411483887417)
        self.assertAlmostEqual(cpl.bien('01111100'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('01111101'), 0.23797261801876332)
        self.assertAlmostEqual(cpl.bien('01111110'), 0.46743129167867215)
        self.assertAlmostEqual(cpl.bien('01111111'), 0.9170735521822547)
        self.assertAlmostEqual(cpl.bien('10000000'), 0.9170735521822547)
        self.assertAlmostEqual(cpl.bien('10000001'), 0.46743129167867215)
        self.assertAlmostEqual(cpl.bien('10000010'), 0.23797261801876332)
        self.assertAlmostEqual(cpl.bien('10000011'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('10000100'), 0.4562411483887417)
        self.assertAlmostEqual(cpl.bien('10000101'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('10000110'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('10000111'), 0.1141247708092174)
        self.assertAlmostEqual(cpl.bien('10001000'), 0.053399483437225476)
        self.assertAlmostEqual(cpl.bien('10001001'), 0.9349560240267725)
        self.assertAlmostEqual(cpl.bien('10001010'), 0.9487195268740418)
        self.assertAlmostEqual(cpl.bien('10001011'), 0.45772714740874854)
        self.assertAlmostEqual(cpl.bien('10001100'), 0.9421929243961734)
        self.assertAlmostEqual(cpl.bien('10001101'), 0.23945861703877014)
        self.assertAlmostEqual(cpl.bien('10001110'), 0.45515378785140964)
        self.assertAlmostEqual(cpl.bien('10001111'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('10010000'), 0.4719276050543988)
        self.assertAlmostEqual(cpl.bien('10010001'), 0.9349560240267725)
        self.assertAlmostEqual(cpl.bien('10010010'), 0.9487195268740418)
        self.assertAlmostEqual(cpl.bien('10010011'), 0.2310090607425139)
        self.assertAlmostEqual(cpl.bien('10010100'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('10010101'), 0.4489560656868124)
        self.assertAlmostEqual(cpl.bien('10010110'), 0.1115514112518785)
        self.assertAlmostEqual(cpl.bien('10010111'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('10011000'), 0.9265064677305163)
        self.assertAlmostEqual(cpl.bien('10011001'), 0.023389419465106323)
        self.assertAlmostEqual(cpl.bien('10011010'), 0.4532308340330219)
        self.assertAlmostEqual(cpl.bien('10011011'), 0.9421929243961734)
        self.assertAlmostEqual(cpl.bien('10011100'), 0.2310090607425139)
        self.assertAlmostEqual(cpl.bien('10011101'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('10011110'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('10011111'), 0.454318194570354)
        self.assertAlmostEqual(cpl.bien('10100000'), 0.22952306172250708)
        self.assertAlmostEqual(cpl.bien('10100001'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('10100010'), 0.9330330702083848)
        self.assertAlmostEqual(cpl.bien('10100011'), 0.47341360407440564)
        self.assertAlmostEqual(cpl.bien('10100100'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('10100101'), 0.10727664290566899)
        self.assertAlmostEqual(cpl.bien('10100110'), 0.4532308340330219)
        self.assertAlmostEqual(cpl.bien('10100111'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('10101000'), 0.9402699705777856)
        self.assertAlmostEqual(cpl.bien('10101001'), 0.4489560656868124)
        self.assertAlmostEqual(cpl.bien('10101010'), 0.007874015748031496)
        self.assertAlmostEqual(cpl.bien('10101011'), 0.920308745565919)
        self.assertAlmostEqual(cpl.bien('10101100'), 0.4558041935903608)
        self.assertAlmostEqual(cpl.bien('10101101'), 0.9444447585278324)
        self.assertAlmostEqual(cpl.bien('10101110'), 0.9487195268740418)
        self.assertAlmostEqual(cpl.bien('10101111'), 0.22952306172250708)
        self.assertAlmostEqual(cpl.bien('10110000'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('10110001'), 0.23945861703877014)
        self.assertAlmostEqual(cpl.bien('10110010'), 0.468917290698679)
        self.assertAlmostEqual(cpl.bien('10110011'), 0.9265064677305163)
        self.assertAlmostEqual(cpl.bien('10110100'), 0.1141247708092174)
        self.assertAlmostEqual(cpl.bien('10110101'), 0.9444447585278324)
        self.assertAlmostEqual(cpl.bien('10110110'), 0.9487195268740418)
        self.assertAlmostEqual(cpl.bien('10110111'), 0.4562411483887417)
        self.assertAlmostEqual(cpl.bien('10111000'), 0.45772714740874854)
        self.assertAlmostEqual(cpl.bien('10111001'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('10111010'), 0.9330330702083848)
        self.assertAlmostEqual(cpl.bien('10111011'), 0.053399483437225476)
        self.assertAlmostEqual(cpl.bien('10111100'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('10111101'), 0.4536677888314028)
        self.assertAlmostEqual(cpl.bien('10111110'), 0.23797261801876332)
        self.assertAlmostEqual(cpl.bien('10111111'), 0.9370347771941213)
        self.assertAlmostEqual(cpl.bien('11000000'), 0.44747006666680555)
        self.assertAlmostEqual(cpl.bien('11000001'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('11000010'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('11000011'), 0.1115514112518785)
        self.assertAlmostEqual(cpl.bien('11000100'), 0.9349560240267725)
        self.assertAlmostEqual(cpl.bien('11000101'), 0.47341360407440564)
        self.assertAlmostEqual(cpl.bien('11000110'), 0.2310090607425139)
        self.assertAlmostEqual(cpl.bien('11000111'), 0.9487195268740418)
        self.assertAlmostEqual(cpl.bien('11001000'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('11001001'), 0.2310090607425139)
        self.assertAlmostEqual(cpl.bien('11001010'), 0.4558041935903608)
        self.assertAlmostEqual(cpl.bien('11001011'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('11001100'), 0.023389419465106323)
        self.assertAlmostEqual(cpl.bien('11001101'), 0.9265064677305163)
        self.assertAlmostEqual(cpl.bien('11001110'), 0.9421929243961734)
        self.assertAlmostEqual(cpl.bien('11001111'), 0.45174483501301504)
        self.assertAlmostEqual(cpl.bien('11010000'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('11010001'), 0.45772714740874854)
        self.assertAlmostEqual(cpl.bien('11010010'), 0.1141247708092174)
        self.assertAlmostEqual(cpl.bien('11010011'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('11010100'), 0.468917290698679)
        self.assertAlmostEqual(cpl.bien('11010101'), 0.920308745565919)
        self.assertAlmostEqual(cpl.bien('11010110'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('11010111'), 0.23797261801876332)
        self.assertAlmostEqual(cpl.bien('11011000'), 0.23945861703877014)
        self.assertAlmostEqual(cpl.bien('11011001'), 0.9421929243961734)
        self.assertAlmostEqual(cpl.bien('11011010'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('11011011'), 0.4536677888314028)
        self.assertAlmostEqual(cpl.bien('11011100'), 0.9349560240267725)
        self.assertAlmostEqual(cpl.bien('11011101'), 0.053399483437225476)
        self.assertAlmostEqual(cpl.bien('11011110'), 0.4562411483887417)
        self.assertAlmostEqual(cpl.bien('11011111'), 0.9454843334903775)
        self.assertAlmostEqual(cpl.bien('11100000'), 0.9444447585278324)
        self.assertAlmostEqual(cpl.bien('11100001'), 0.1141247708092174)
        self.assertAlmostEqual(cpl.bien('11100010'), 0.45772714740874854)
        self.assertAlmostEqual(cpl.bien('11100011'), 0.9487195268740418)
        self.assertAlmostEqual(cpl.bien('11100100'), 0.23945861703877014)
        self.assertAlmostEqual(cpl.bien('11100101'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('11100110'), 0.9265064677305163)
        self.assertAlmostEqual(cpl.bien('11100111'), 0.46743129167867215)
        self.assertAlmostEqual(cpl.bien('11101000'), 0.45515378785140964)
        self.assertAlmostEqual(cpl.bien('11101001'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('11101010'), 0.9402699705777856)
        self.assertAlmostEqual(cpl.bien('11101011'), 0.23797261801876332)
        self.assertAlmostEqual(cpl.bien('11101100'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('11101101'), 0.4562411483887417)
        self.assertAlmostEqual(cpl.bien('11101110'), 0.053399483437225476)
        self.assertAlmostEqual(cpl.bien('11101111'), 0.9297978768247205)
        self.assertAlmostEqual(cpl.bien('11110000'), 0.10727664290566898)
        self.assertAlmostEqual(cpl.bien('11110001'), 0.9512928864313808)
        self.assertAlmostEqual(cpl.bien('11110010'), 0.9532158402497685)
        self.assertAlmostEqual(cpl.bien('11110011'), 0.45174483501301504)
        self.assertAlmostEqual(cpl.bien('11110100'), 0.9506424806924296)
        self.assertAlmostEqual(cpl.bien('11110101'), 0.22952306172250708)
        self.assertAlmostEqual(cpl.bien('11110110'), 0.4719276050543988)
        self.assertAlmostEqual(cpl.bien('11110111'), 0.9297978768247205)
        self.assertAlmostEqual(cpl.bien('11111000'), 0.9444447585278324)
        self.assertAlmostEqual(cpl.bien('11111001'), 0.454318194570354)
        self.assertAlmostEqual(cpl.bien('11111010'), 0.22952306172250708)
        self.assertAlmostEqual(cpl.bien('11111011'), 0.9454843334903775)
        self.assertAlmostEqual(cpl.bien('11111100'), 0.44747006666680555)
        self.assertAlmostEqual(cpl.bien('11111101'), 0.9370347771941213)
        self.assertAlmostEqual(cpl.bien('11111110'), 0.9170735521822547)
        self.assertAlmostEqual(cpl.bien('11111111'), 0.0)

    def test_tbien(self):
        # 2-bit strings
        self.assertEqual(cpl.tbien('00'), 0.0)
        self.assertEqual(cpl.tbien('01'), 1.0)
        self.assertEqual(cpl.tbien('10'), 1.0)
        self.assertEqual(cpl.tbien('11'), 0.0)
        # 4-bit strings, asserts equality to 7 decimal places
        self.assertAlmostEqual(cpl.tbien('0000'), 0.0)
        self.assertAlmostEqual(cpl.tbien('0001'), 0.9305948708049089)
        self.assertAlmostEqual(cpl.tbien('0010'), 0.9305948708049089)
        self.assertAlmostEqual(cpl.tbien('0011'), 0.5355473378808682)
        self.assertAlmostEqual(cpl.tbien('0100'), 0.9305948708049089)
        self.assertAlmostEqual(cpl.tbien('0101'), 0.21810429198553155)
        self.assertAlmostEqual(cpl.tbien('0110'), 0.5355473378808682)
        self.assertAlmostEqual(cpl.tbien('0111'), 0.9305948708049089)
        self.assertAlmostEqual(cpl.tbien('1000'), 0.9305948708049089)
        self.assertAlmostEqual(cpl.tbien('1001'), 0.5355473378808682)
        self.assertAlmostEqual(cpl.tbien('1010'), 0.21810429198553155)
        self.assertAlmostEqual(cpl.tbien('1011'), 0.9305948708049089)
        self.assertAlmostEqual(cpl.tbien('1100'), 0.5355473378808682)
        self.assertAlmostEqual(cpl.tbien('1101'), 0.9305948708049089)
        self.assertAlmostEqual(cpl.tbien('1110'), 0.9305948708049089)
        self.assertAlmostEqual(cpl.tbien('1111'), 0.0)
        # 8-bit strings, asserts equality to 7 decimal places
        self.assertAlmostEqual(cpl.tbien('00000000'), 0.0)
        self.assertAlmostEqual(cpl.tbien('00000001'), 0.7930318630672043)
        self.assertAlmostEqual(cpl.tbien('00000010'), 0.8589468375430831)
        self.assertAlmostEqual(cpl.tbien('00000011'), 0.6813985994017482)
        self.assertAlmostEqual(cpl.tbien('00000100'), 0.8940170728237214)
        self.assertAlmostEqual(cpl.tbien('00000101'), 0.5563891001761716)
        self.assertAlmostEqual(cpl.tbien('00000110'), 0.7202007974767275)
        self.assertAlmostEqual(cpl.tbien('00000111'), 0.8927513204867304)
        self.assertAlmostEqual(cpl.tbien('00001000'), 0.8562234604151914)
        self.assertAlmostEqual(cpl.tbien('00001001'), 0.7706444709379511)
        self.assertAlmostEqual(cpl.tbien('00001010'), 0.5563891001761716)
        self.assertAlmostEqual(cpl.tbien('00001011'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('00001100'), 0.7095199614690969)
        self.assertAlmostEqual(cpl.tbien('00001101'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('00001110'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('00001111'), 0.3940627705450895)
        self.assertAlmostEqual(cpl.tbien('00010000'), 0.8562234604151914)
        self.assertAlmostEqual(cpl.tbien('00010001'), 0.28582053198265955)
        self.assertAlmostEqual(cpl.tbien('00010010'), 0.732850858529421)
        self.assertAlmostEqual(cpl.tbien('00010011'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('00010100'), 0.59145933545681)
        self.assertAlmostEqual(cpl.tbien('00010101'), 0.8858024472734408)
        self.assertAlmostEqual(cpl.tbien('00010110'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('00010111'), 0.7345054241526495)
        self.assertAlmostEqual(cpl.tbien('00011000'), 0.747313573877627)
        self.assertAlmostEqual(cpl.tbien('00011001'), 0.8606588959176042)
        self.assertAlmostEqual(cpl.tbien('00011010'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('00011011'), 0.6037947370876691)
        self.assertAlmostEqual(cpl.tbien('00011100'), 0.9208726825540792)
        self.assertAlmostEqual(cpl.tbien('00011101'), 0.7451862601602801)
        self.assertAlmostEqual(cpl.tbien('00011110'), 0.43286496862006874)
        self.assertAlmostEqual(cpl.tbien('00011111'), 0.8927513204867304)
        self.assertAlmostEqual(cpl.tbien('00100000'), 0.8940170728237214)
        self.assertAlmostEqual(cpl.tbien('00100001'), 0.732850858529421)
        self.assertAlmostEqual(cpl.tbien('00100010'), 0.28582053198265955)
        self.assertAlmostEqual(cpl.tbien('00100011'), 0.8957291311982426)
        self.assertAlmostEqual(cpl.tbien('00100100'), 0.7221700225217904)
        self.assertAlmostEqual(cpl.tbien('00100101'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('00100110'), 0.8984525083261343)
        self.assertAlmostEqual(cpl.tbien('00100111'), 0.6037947370876691)
        self.assertAlmostEqual(cpl.tbien('00101000'), 0.59145933545681)
        self.assertAlmostEqual(cpl.tbien('00101001'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('00101010'), 0.819887472797562)
        self.assertAlmostEqual(cpl.tbien('00101011'), 0.7596489755084861)
        self.assertAlmostEqual(cpl.tbien('00101100'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('00101101'), 0.43286496862006874)
        self.assertAlmostEqual(cpl.tbien('00101110'), 0.7451862601602801)
        self.assertAlmostEqual(cpl.tbien('00101111'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('00110000'), 0.7095199614690969)
        self.assertAlmostEqual(cpl.tbien('00110001'), 0.8984525083261343)
        self.assertAlmostEqual(cpl.tbien('00110010'), 0.8606588959176042)
        self.assertAlmostEqual(cpl.tbien('00110011'), 0.1674302125437542)
        self.assertAlmostEqual(cpl.tbien('00110100'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('00110101'), 0.7325361991075866)
        self.assertAlmostEqual(cpl.tbien('00110110'), 0.5687245018070307)
        self.assertAlmostEqual(cpl.tbien('00110111'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('00111000'), 0.9208726825540792)
        self.assertAlmostEqual(cpl.tbien('00111001'), 0.5687245018070307)
        self.assertAlmostEqual(cpl.tbien('00111010'), 0.7829798725688102)
        self.assertAlmostEqual(cpl.tbien('00111011'), 0.8957291311982426)
        self.assertAlmostEqual(cpl.tbien('00111100'), 0.4221841326124382)
        self.assertAlmostEqual(cpl.tbien('00111101'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('00111110'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('00111111'), 0.6813985994017482)
        self.assertAlmostEqual(cpl.tbien('01000000'), 0.8589468375430831)
        self.assertAlmostEqual(cpl.tbien('01000001'), 0.59145933545681)
        self.assertAlmostEqual(cpl.tbien('01000010'), 0.7221700225217904)
        self.assertAlmostEqual(cpl.tbien('01000011'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('01000100'), 0.28582053198265955)
        self.assertAlmostEqual(cpl.tbien('01000101'), 0.8830790701455491)
        self.assertAlmostEqual(cpl.tbien('01000110'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('01000111'), 0.7451862601602801)
        self.assertAlmostEqual(cpl.tbien('01001000'), 0.732850858529421)
        self.assertAlmostEqual(cpl.tbien('01001001'), 0.9208726825540792)
        self.assertAlmostEqual(cpl.tbien('01001010'), 0.8927513204867304)
        self.assertAlmostEqual(cpl.tbien('01001011'), 0.43286496862006874)
        self.assertAlmostEqual(cpl.tbien('01001100'), 0.8606588959176042)
        self.assertAlmostEqual(cpl.tbien('01001101'), 0.7596489755084861)
        self.assertAlmostEqual(cpl.tbien('01001110'), 0.6037947370876691)
        self.assertAlmostEqual(cpl.tbien('01001111'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('01010000'), 0.5563891001761716)
        self.assertAlmostEqual(cpl.tbien('01010001'), 0.9208726825540792)
        self.assertAlmostEqual(cpl.tbien('01010010'), 0.8927513204867304)
        self.assertAlmostEqual(cpl.tbien('01010011'), 0.7325361991075866)
        self.assertAlmostEqual(cpl.tbien('01010100'), 0.819887472797562)
        self.assertAlmostEqual(cpl.tbien('01010101'), 0.06536286053488224)
        self.assertAlmostEqual(cpl.tbien('01010110'), 0.6937340010326074)
        self.assertAlmostEqual(cpl.tbien('01010111'), 0.8858024472734408)
        self.assertAlmostEqual(cpl.tbien('01011000'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('01011001'), 0.721855363099956)
        self.assertAlmostEqual(cpl.tbien('01011010'), 0.39406277054508954)
        self.assertAlmostEqual(cpl.tbien('01011011'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('01011100'), 0.7829798725688102)
        self.assertAlmostEqual(cpl.tbien('01011101'), 0.8830790701455491)
        self.assertAlmostEqual(cpl.tbien('01011110'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('01011111'), 0.5563891001761716)
        self.assertAlmostEqual(cpl.tbien('01100000'), 0.7202007974767275)
        self.assertAlmostEqual(cpl.tbien('01100001'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('01100010'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('01100011'), 0.5687245018070307)
        self.assertAlmostEqual(cpl.tbien('01100100'), 0.8984525083261343)
        self.assertAlmostEqual(cpl.tbien('01100101'), 0.721855363099956)
        self.assertAlmostEqual(cpl.tbien('01100110'), 0.1674302125437542)
        self.assertAlmostEqual(cpl.tbien('01100111'), 0.8606588959176042)
        self.assertAlmostEqual(cpl.tbien('01101000'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('01101001'), 0.4221841326124382)
        self.assertAlmostEqual(cpl.tbien('01101010'), 0.6937340010326074)
        self.assertAlmostEqual(cpl.tbien('01101011'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('01101100'), 0.5687245018070307)
        self.assertAlmostEqual(cpl.tbien('01101101'), 0.9208726825540792)
        self.assertAlmostEqual(cpl.tbien('01101110'), 0.8957291311982426)
        self.assertAlmostEqual(cpl.tbien('01101111'), 0.7706444709379511)
        self.assertAlmostEqual(cpl.tbien('01110000'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('01110001'), 0.7345054241526495)
        self.assertAlmostEqual(cpl.tbien('01110010'), 0.6037947370876691)
        self.assertAlmostEqual(cpl.tbien('01110011'), 0.8984525083261343)
        self.assertAlmostEqual(cpl.tbien('01110100'), 0.7451862601602801)
        self.assertAlmostEqual(cpl.tbien('01110101'), 0.9208726825540792)
        self.assertAlmostEqual(cpl.tbien('01110110'), 0.8957291311982426)
        self.assertAlmostEqual(cpl.tbien('01110111'), 0.28582053198265955)
        self.assertAlmostEqual(cpl.tbien('01111000'), 0.43286496862006874)
        self.assertAlmostEqual(cpl.tbien('01111001'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('01111010'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('01111011'), 0.732850858529421)
        self.assertAlmostEqual(cpl.tbien('01111100'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('01111101'), 0.59145933545681)
        self.assertAlmostEqual(cpl.tbien('01111110'), 0.747313573877627)
        self.assertAlmostEqual(cpl.tbien('01111111'), 0.7930318630672043)
        self.assertAlmostEqual(cpl.tbien('10000000'), 0.7930318630672043)
        self.assertAlmostEqual(cpl.tbien('10000001'), 0.747313573877627)
        self.assertAlmostEqual(cpl.tbien('10000010'), 0.59145933545681)
        self.assertAlmostEqual(cpl.tbien('10000011'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('10000100'), 0.732850858529421)
        self.assertAlmostEqual(cpl.tbien('10000101'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('10000110'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('10000111'), 0.43286496862006874)
        self.assertAlmostEqual(cpl.tbien('10001000'), 0.28582053198265955)
        self.assertAlmostEqual(cpl.tbien('10001001'), 0.8957291311982426)
        self.assertAlmostEqual(cpl.tbien('10001010'), 0.9208726825540792)
        self.assertAlmostEqual(cpl.tbien('10001011'), 0.7451862601602801)
        self.assertAlmostEqual(cpl.tbien('10001100'), 0.8984525083261343)
        self.assertAlmostEqual(cpl.tbien('10001101'), 0.6037947370876691)
        self.assertAlmostEqual(cpl.tbien('10001110'), 0.7345054241526495)
        self.assertAlmostEqual(cpl.tbien('10001111'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('10010000'), 0.7706444709379511)
        self.assertAlmostEqual(cpl.tbien('10010001'), 0.8957291311982426)
        self.assertAlmostEqual(cpl.tbien('10010010'), 0.9208726825540792)
        self.assertAlmostEqual(cpl.tbien('10010011'), 0.5687245018070307)
        self.assertAlmostEqual(cpl.tbien('10010100'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('10010101'), 0.6937340010326074)
        self.assertAlmostEqual(cpl.tbien('10010110'), 0.4221841326124382)
        self.assertAlmostEqual(cpl.tbien('10010111'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('10011000'), 0.8606588959176042)
        self.assertAlmostEqual(cpl.tbien('10011001'), 0.1674302125437542)
        self.assertAlmostEqual(cpl.tbien('10011010'), 0.721855363099956)
        self.assertAlmostEqual(cpl.tbien('10011011'), 0.8984525083261343)
        self.assertAlmostEqual(cpl.tbien('10011100'), 0.5687245018070307)
        self.assertAlmostEqual(cpl.tbien('10011101'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('10011110'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('10011111'), 0.7202007974767275)
        self.assertAlmostEqual(cpl.tbien('10100000'), 0.5563891001761716)
        self.assertAlmostEqual(cpl.tbien('10100001'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('10100010'), 0.8830790701455491)
        self.assertAlmostEqual(cpl.tbien('10100011'), 0.7829798725688102)
        self.assertAlmostEqual(cpl.tbien('10100100'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('10100101'), 0.39406277054508954)
        self.assertAlmostEqual(cpl.tbien('10100110'), 0.721855363099956)
        self.assertAlmostEqual(cpl.tbien('10100111'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('10101000'), 0.8858024472734408)
        self.assertAlmostEqual(cpl.tbien('10101001'), 0.6937340010326074)
        self.assertAlmostEqual(cpl.tbien('10101010'), 0.06536286053488224)
        self.assertAlmostEqual(cpl.tbien('10101011'), 0.819887472797562)
        self.assertAlmostEqual(cpl.tbien('10101100'), 0.7325361991075866)
        self.assertAlmostEqual(cpl.tbien('10101101'), 0.8927513204867304)
        self.assertAlmostEqual(cpl.tbien('10101110'), 0.9208726825540792)
        self.assertAlmostEqual(cpl.tbien('10101111'), 0.5563891001761716)
        self.assertAlmostEqual(cpl.tbien('10110000'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('10110001'), 0.6037947370876691)
        self.assertAlmostEqual(cpl.tbien('10110010'), 0.7596489755084861)
        self.assertAlmostEqual(cpl.tbien('10110011'), 0.8606588959176042)
        self.assertAlmostEqual(cpl.tbien('10110100'), 0.43286496862006874)
        self.assertAlmostEqual(cpl.tbien('10110101'), 0.8927513204867304)
        self.assertAlmostEqual(cpl.tbien('10110110'), 0.9208726825540792)
        self.assertAlmostEqual(cpl.tbien('10110111'), 0.732850858529421)
        self.assertAlmostEqual(cpl.tbien('10111000'), 0.7451862601602801)
        self.assertAlmostEqual(cpl.tbien('10111001'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('10111010'), 0.8830790701455491)
        self.assertAlmostEqual(cpl.tbien('10111011'), 0.28582053198265955)
        self.assertAlmostEqual(cpl.tbien('10111100'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('10111101'), 0.7221700225217904)
        self.assertAlmostEqual(cpl.tbien('10111110'), 0.59145933545681)
        self.assertAlmostEqual(cpl.tbien('10111111'), 0.8589468375430831)
        self.assertAlmostEqual(cpl.tbien('11000000'), 0.6813985994017482)
        self.assertAlmostEqual(cpl.tbien('11000001'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('11000010'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('11000011'), 0.4221841326124382)
        self.assertAlmostEqual(cpl.tbien('11000100'), 0.8957291311982426)
        self.assertAlmostEqual(cpl.tbien('11000101'), 0.7829798725688102)
        self.assertAlmostEqual(cpl.tbien('11000110'), 0.5687245018070307)
        self.assertAlmostEqual(cpl.tbien('11000111'), 0.9208726825540792)
        self.assertAlmostEqual(cpl.tbien('11001000'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('11001001'), 0.5687245018070307)
        self.assertAlmostEqual(cpl.tbien('11001010'), 0.7325361991075866)
        self.assertAlmostEqual(cpl.tbien('11001011'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('11001100'), 0.1674302125437542)
        self.assertAlmostEqual(cpl.tbien('11001101'), 0.8606588959176042)
        self.assertAlmostEqual(cpl.tbien('11001110'), 0.8984525083261343)
        self.assertAlmostEqual(cpl.tbien('11001111'), 0.7095199614690969)
        self.assertAlmostEqual(cpl.tbien('11010000'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('11010001'), 0.7451862601602801)
        self.assertAlmostEqual(cpl.tbien('11010010'), 0.43286496862006874)
        self.assertAlmostEqual(cpl.tbien('11010011'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('11010100'), 0.7596489755084861)
        self.assertAlmostEqual(cpl.tbien('11010101'), 0.819887472797562)
        self.assertAlmostEqual(cpl.tbien('11010110'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('11010111'), 0.59145933545681)
        self.assertAlmostEqual(cpl.tbien('11011000'), 0.6037947370876691)
        self.assertAlmostEqual(cpl.tbien('11011001'), 0.8984525083261343)
        self.assertAlmostEqual(cpl.tbien('11011010'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('11011011'), 0.7221700225217904)
        self.assertAlmostEqual(cpl.tbien('11011100'), 0.8957291311982426)
        self.assertAlmostEqual(cpl.tbien('11011101'), 0.28582053198265955)
        self.assertAlmostEqual(cpl.tbien('11011110'), 0.732850858529421)
        self.assertAlmostEqual(cpl.tbien('11011111'), 0.8940170728237214)
        self.assertAlmostEqual(cpl.tbien('11100000'), 0.8927513204867304)
        self.assertAlmostEqual(cpl.tbien('11100001'), 0.43286496862006874)
        self.assertAlmostEqual(cpl.tbien('11100010'), 0.7451862601602801)
        self.assertAlmostEqual(cpl.tbien('11100011'), 0.9208726825540792)
        self.assertAlmostEqual(cpl.tbien('11100100'), 0.6037947370876691)
        self.assertAlmostEqual(cpl.tbien('11100101'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('11100110'), 0.8606588959176042)
        self.assertAlmostEqual(cpl.tbien('11100111'), 0.747313573877627)
        self.assertAlmostEqual(cpl.tbien('11101000'), 0.7345054241526495)
        self.assertAlmostEqual(cpl.tbien('11101001'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('11101010'), 0.8858024472734408)
        self.assertAlmostEqual(cpl.tbien('11101011'), 0.59145933545681)
        self.assertAlmostEqual(cpl.tbien('11101100'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('11101101'), 0.732850858529421)
        self.assertAlmostEqual(cpl.tbien('11101110'), 0.28582053198265955)
        self.assertAlmostEqual(cpl.tbien('11101111'), 0.8562234604151914)
        self.assertAlmostEqual(cpl.tbien('11110000'), 0.3940627705450895)
        self.assertAlmostEqual(cpl.tbien('11110001'), 0.9315535185617098)
        self.assertAlmostEqual(cpl.tbien('11110010'), 0.9442035796144033)
        self.assertAlmostEqual(cpl.tbien('11110011'), 0.7095199614690969)
        self.assertAlmostEqual(cpl.tbien('11110100'), 0.9335227436067727)
        self.assertAlmostEqual(cpl.tbien('11110101'), 0.5563891001761716)
        self.assertAlmostEqual(cpl.tbien('11110110'), 0.7706444709379511)
        self.assertAlmostEqual(cpl.tbien('11110111'), 0.8562234604151914)
        self.assertAlmostEqual(cpl.tbien('11111000'), 0.8927513204867304)
        self.assertAlmostEqual(cpl.tbien('11111001'), 0.7202007974767275)
        self.assertAlmostEqual(cpl.tbien('11111010'), 0.5563891001761716)
        self.assertAlmostEqual(cpl.tbien('11111011'), 0.8940170728237214)
        self.assertAlmostEqual(cpl.tbien('11111100'), 0.6813985994017482)
        self.assertAlmostEqual(cpl.tbien('11111101'), 0.8589468375430831)
        self.assertAlmostEqual(cpl.tbien('11111110'), 0.7930318630672043)
        self.assertAlmostEqual(cpl.tbien('11111111'), 0.0)

    def test_cyclic_binary_derivative(self):
        self.assertEqual(cpl.cyclic_binary_derivative('10101110'), '11110011')
        self.assertEqual(cpl.cyclic_binary_derivative('11110011'), '00010100')
        self.assertEqual(cpl.cyclic_binary_derivative('00010100'), '00111100')
        self.assertEqual(cpl.cyclic_binary_derivative('00111100'), '01000100')
        self.assertEqual(cpl.cyclic_binary_derivative('01000100'), '11001100')
        self.assertEqual(cpl.cyclic_binary_derivative('11001100'), '01010101')
        self.assertEqual(cpl.cyclic_binary_derivative('01010101'), '11111111')

    def test_ktbien(self):
        # 2-bit strings
        self.assertEqual(cpl.ktbien('00'), 0.0)
        self.assertEqual(cpl.ktbien('01'), 1.0)
        self.assertEqual(cpl.ktbien('10'), 1.0)
        self.assertEqual(cpl.ktbien('11'), 0.0)
        # other cases
        self.assertAlmostEqual(cpl.ktbien('10101110'), 0.9209131731629818)
